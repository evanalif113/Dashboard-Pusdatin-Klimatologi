<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <!--reference for favicon-->
    <link rel="icon" type="image/png" href="./Logo.png">
    <!--reference to CSS-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css" href="./style/styleHome.css">
    <script type="module">
      // Import Highcharts
      import Highcharts from "https://code.highcharts.com/highcharts.js";
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js";
      import { getDatabase } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";
      import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
      // TODO: Add SDKs for Firebase products that you want to use
      // https://firebase.google.com/docs/web/setup#available-libraries
    
      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
        apiKey: "",
        authDomain: "",
        databaseURL: "",
        projectId: "",
        storageBucket: "",
        messagingSenderId: "",
        appId: "",
        measurementId: ""
      };
    
      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);
      const auth = getAuth();
      const database = getDatabase();

      console.log(app);
    </script>
    <!-- include to use jquery-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <!--include icons from fontawesome-->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
    <!--Judul Website-->
    <title>Pusat Data Iklim Jerukagung Seismologi</title>
  </head>
  <body>
    <!--MAIN PAGE HOMEs-->
    <div class="mainpage">
      <div class="container">
        <div class="topnav">
          <a href="#home">Home</a>
          <a href="#news">News</a>
          <a href="#contact">Contact</a>
          <a href="./thingspeak.html">More</a>
        </div>
      </div>
      <h1 class="mainpagetext">Selamat Datang di Pusat Data Iklim Jerukagung</h1>
      <p class="mainpagetext">Penelitian dan Pengembangan Stasiun Iklim Jerukagung Seismologi</p>
    </div>
    <!-- Stasiun Iklim Jerukagung-->
    <div class="dashboard" id="stasiun-1">
      <div class="stasiun-title">
        <img src="./logo.png" style="height: 50px; margin-right: 10px;">
        Stasiun Riset Meteorologi Jerukagung
      </div>
      <p style="font-size: 16px; margin-bottom: 20px;">
        Pemantauan iklim dan kondisi cuaca secara real-time untuk mendukung penelitian dinamika atmosfer di Jerukagung.
      </p>
      <div class="iframe-container">
        <iframe src="https://thingspeak.com/channels/1733232/charts/1?bgcolor=%23ffffff&color=%2300b3b3&dynamic=true&results=60&title=Suhu Lingkungan&type=spline&xaxis=Time&yaxis=Suhu Lingkungan+%28%C2%B0C%29"></iframe>
        <iframe src="https://thingspeak.com/channels/1733232/charts/2?bgcolor=%23ffffff&color=%230fa67e&dynamic=true&results=60&title=Kelembapan Relatif&type=spline&xaxis=Time&yaxis=Kelembapan Relatif+%28%25%29"></iframe>
        <iframe src="https://thingspeak.com/channels/1733232/charts/3?bgcolor=%23ffffff&color=%23f68923&dynamic=true&results=60&round=5&title=Tekanan Udara&type=spline&xaxis=Time&yaxis=Tekanan Udara+%28hPa%29"></iframe>
      </div>
    </div>
    <!-- Stasiun Riset Klimatologi Jerukagung -->
    <div class="dashboard" id="stasiun-2">
      <div class="stasiun-title">
        <img src="./logo.png" style="height: 50px; margin-right: 10px;">
        Stasiun Riset Klimatologi Jerukagung
      </div>
      <p style="font-size: 16px; margin-bottom: 20px;">
        Pemantauan iklim dan kondisi cuaca secara real-time untuk mendukung penelitian Agroklimat di Jerukagung.
      </p>
      <div class="iframe-container">
        <iframe src="https://thingspeak.com/channels/2326256/charts/1?bgcolor=%23ffffff&color=%2300b3b3&dynamic=true&results=60&title=Suhu+Lingkungan&type=spline"></iframe>
        <iframe src="https://thingspeak.com/channels/2326256/charts/2?bgcolor=%23ffffff&color=%230fa67e&dynamic=true&results=60&title=Kelembapan+Relatif&type=spline"></iframe>
        <iframe src="https://thingspeak.com/channels/2326256/charts/3?bgcolor=%23ffffff&color=%23f68923&dynamic=true&results=60&title=Tekanan+Udara&type=spline"></iframe>
      </div>
      <div class="rata-rata" id="rata-rata-suhu3"></div>
      <div class="rata-rata" id="rata-rata-kelembaban3"></div>
      <div class="rata-rata" id="rata-rata-tekanan3"></div>
    </div>
    <!-- Stasiun Riset Seismologi Jerukagung -->
     <div class="dashboard" id="stasiun-3">
      <div class="stasiun-title">
        <img src="./logo.png" style="height: 50px; margin-right: 10px;">
        Stasiun Riset Seismologi Jerukagung
      </div>
      <p style="font-size: 16px; margin-bottom: 20px;">
        Pemantauan gempa bumi dan aktivitas seismik secara real-time untuk mendukung penelitian seismologi di Jerukagung.
      </p>
      <div class="iframe-container">
        </div>
     </div>
    <script>
      // mengambil data
  function meanThingspeak(channelID, fieldNumber, numResults, resultElementId, dataType) {
  const apiKey = '6NPQMVGO26LY3UCP'; 
  const url = `https://api.thingspeak.com/channels/${channelID}/fields/${fieldNumber}.json?api_key=${apiKey}&results=${numResults}`;
  
  let dataTypeText;
  switch (dataType) {
    case 1:
      dataTypeText = "Suhu";
      break;
    case 2:
      dataTypeText = "Kelembapan";
      break;
    case 3:
      dataTypeText = "Tekanan Udara";
      break;
    default:
      dataTypeText = "Data";
  }

  fetch(url)
    .then((response) => response.json())
    .then((data) => {
      if (data.feeds && data.feeds.length > 0) {
        const fieldValues = data.feeds.map((feed) => parseFloat(feed[`field${fieldNumber}`]));
        const rataRata = fieldValues.reduce((total, value) => total + value, 0) / fieldValues.length;

        // Tampilkan rata-rata data
        const rataRataElement = document.getElementById(resultElementId);
        rataRataElement.textContent = `Rata-rata Data ${dataTypeText}: ${rataRata.toFixed(2)}`;
      }
    })
    .catch((error) => {
      console.error('Gagal mengambil data Thingspeak:', error);
    });
}

// panggil rata rata
meanThingspeak(2326256, 1, 60, 'rata-rata-suhu3', 1);
meanThingspeak(2326256, 2, 60, 'rata-rata-kelembaban3', 2);
meanThingspeak(2326256, 3, 60, 'rata-rata-tekanan3', 3);

    </script>
  </body>
  <footer>
    <button type="button" class="btn btn-success" style="font-size: 18px" 
    onclick="sendEmail()">Kontak Jerukagung Seismologi
    </button>
  </footer>  
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <script src="./script/index.js"></script>
  <script src="./script/chart.js"></script>
</html>
